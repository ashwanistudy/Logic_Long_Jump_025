<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Merge Sort</title>
    <link rel="stylesheet" href="./algo_style.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />

    <style>
      #first {
        width: 95%;
        height: 20rem;
        background-color: white;
        margin: auto;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden; /* Prevents scrollbars */
      }
      #first > span {
        padding: 0.5rem 1rem;
        background-color: navajowhite;
        font-size: 1.5rem;
        margin: 0.5rem;
        position: absolute;
        text-align: center;
        line-height: 2rem;
        transition: transform 0.5s ease, background-color 0.5s ease;
        z-index: 1;
        left: 50%; /* Center horizontally */
        transform: translateX(-50%); /* Offset from left by half its width */
      }
      .current-min {
        background-color: #FF004D;
        z-index: 2;
      }
      .lifted {
        animation: lift 0.5s ease forwards;
      }
      .swapping {
        animation: swap 0.5s ease forwards;
      }
      @keyframes lift {
        0% {
          transform: translateY(0) scale(1);
        }
        50% {
          transform: translateY(-100px) scale(1.2);
        }
        100% {
          transform: translateY(-100px) scale(1.2);
        }
      }
      @keyframes swap {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.2);
        }
        100% {
          transform: scale(1);
        }
      }
      #second {
        width: 95%;
        margin: auto;
        display: flex;
        justify-content: center;
        margin-top: 1rem;
      }
      input {
        width: 5rem;
        height: 2rem;
        padding: 1.5rem;
        font-size: 2rem;
        border: none;
        border-radius: 0.5rem;
      }
      button {
        padding: 1rem 2rem;
        margin-left: 1rem;
        font-size: 2rem;
        font-weight: 600;
        background-color: rgba(0, 128, 0, 0.747);
        cursor: pointer;
        border-radius: 0.5rem;
        border: none;
      }
      button:hover {
        background-color: rgb(6, 206, 6);
      }
      #third {
        background-color: white;
        width: 95%;
        height: 5rem;
        margin: auto;
        border-bottom-left-radius: 0.5rem;
        border-bottom-right-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      #third > span {
        font-size: 1.5rem;
        font-weight: 600;
      }
      #fourth {
        width: 95%;
        margin: auto;
        padding: 2rem;
        background-color: #faef5d;
        border-radius: 0.5rem;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        color: #1d2b53;
        text-align: center;
        position: relative;
        bottom: 0;
      }
      #fourth .info {
        max-width: 800px;
        margin: auto;
      }
      #fourth h2 {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 1rem;
      }
      #fourth h3 {
        font-size: 1.5rem;
        margin-top: 1rem;
      }
      #fourth p {
        font-size: 1.2rem;
        line-height: 1.5;
      }
    </style>
  </head>
  <body>
    <div id="main">
      <!-- nav bar start -->
      <nav>
        <img src="./Main_Logo.jpeg" alt="" />
        <p>Merge Sort Visualization</p>
        <p id="hamburger">=</p>
      </nav>
      <hr style="color: gray" />
      <!-- nav bar end -->

      <!-- First Section start -->
      <section id="first"></section>
      <!-- First Section end -->

      <section id="third"></section>

      <!-- Second Section start -->
      <section id="second">
        <form id="form">
          <input type="number" required id="push" placeholder="0" />
          <button type="submit">Add</button>
        </form>
        <button id="sort-asc">Sort Ascending</button>
        <button id="sort-desc">Sort Descending</button>
      </section>
      <!-- Second Section end -->

     <!-- Fourth Section start -->
<section id="fourth">
  <div class="info">
    <h2>Merge Sort Algorithm</h2>
    <p>
      Merge Sort is a divide-and-conquer sorting algorithm that divides the unsorted list into n sublists, each containing one element, and then merges the sublists to produce a sorted list. It follows a recursive approach where the list is repeatedly split until it consists of single elements, and then merged back together in a sorted manner.
    </p>
    <h3>Algorithm</h3>
    <p>
      1. Divide the unsorted list into n sublists, each containing one element.<br>
      2. Repeatedly merge sublists to produce new sorted sublists until there is only one sublist remaining.<br>
      3. Each merge operation involves comparing the elements of the sublists and combining them in sorted order.<br>
      4. Continue merging until the entire list is sorted.
    </p>
    <h3>Time Complexity</h3>
    <p>
      Best Case: O(n log n)<br>
      Average Case: O(n log n)<br>
      Worst Case: O(n log n)
    </p>
  </div>
</section>
<!-- Fourth Section end -->

    </div>
    <script src="./algo_scripts.js"></script>
    <script>
      let arr = [];
    
      document.getElementById("form").addEventListener("submit", input);
      document.getElementById("sort-asc").addEventListener("click", () => mergeSort(arr, 0, arr.length - 1, true));
      document.getElementById("sort-desc").addEventListener("click", () => mergeSort(arr, 0, arr.length - 1, false));
    
      function input(event) {
        event.preventDefault();
        let val = document.getElementById("push").value;
        arr.push(parseInt(val));
        if (arr.length > 0) {
          show();
        }
        document.getElementById("third").innerHTML = "";
        document.getElementById("third").innerHTML = `<span>Added: ${val}</span>`;
      }
    
      function show() {
        document.getElementById("first").innerHTML = "";
        arr.forEach((ele, index) => {
          let span = document.createElement("span");
          span.innerHTML = `${ele}`;
          span.style.left = `calc(50% + ${index * 80 - (arr.length / 2) * 80}px)`;
          let vision = document.getElementById("first");
          vision.appendChild(span);
        });
      }
    
      async function mergeSort(arr, left, right, isAscending) {
        if (left >= right) return;
    
        const middle = Math.floor((left + right) / 2);
    
        await mergeSort(arr, left, middle, isAscending);
        await mergeSort(arr, middle + 1, right, isAscending);
    
        await merge(arr, left, middle, right, isAscending);
        show();
    
        if (left === 0 && right === arr.length - 1) {
          document.getElementById("third").innerHTML = `<span>Sorting Completed</span>`;
        }
      }
    
      async function merge(arr, left, middle, right, isAscending) {
        const leftArray = arr.slice(left, middle + 1);
        const rightArray = arr.slice(middle + 1, right + 1);
    
        let i = 0,
          j = 0,
          k = left;
    
        while (i < leftArray.length && j < rightArray.length) {
          if (isAscending) {
            if (leftArray[i] <= rightArray[j]) {
              arr[k] = leftArray[i];
              i++;
            } else {
              arr[k] = rightArray[j];
              j++;
            }
          } else {
            if (leftArray[i] >= rightArray[j]) {
              arr[k] = leftArray[i];
              i++;
            } else {
              arr[k] = rightArray[j];
              j++;
            }
          }
          k++;
        }
    
        while (i < leftArray.length) {
          arr[k] = leftArray[i];
          i++;
          k++;
        }
    
        while (j < rightArray.length) {
          arr[k] = rightArray[j];
          j++;
          k++;
        }
    
        await animateMerge(left, right);
      }
    
      function animateMerge(left, right) {
        return new Promise((resolve) => {
          let elements = document.querySelectorAll("#first > span");
          let startPos = elements[left].style.left;
          let endPos = elements[right].style.left;
    
          elements[left].classList.add("lifted");
          elements[right].classList.add("lifted");
    
          setTimeout(() => {
            elements[left].style.left = endPos;
            elements[right].style.left = startPos;
    
            elements[left].classList.remove("lifted");
            elements[right].classList.remove("lifted");
    
            elements[left].classList.add("swapping");
            elements[right].classList.add("swapping");
    
            setTimeout(() => {
              elements[left].classList.remove("swapping");
              elements[right].classList.remove("swapping");
              resolve();
            }, 500);
          }, 500);
        });
      }
    </script>
  </body>
</html>
